{"is_source_file": true, "format": "Java", "description": "This Java class 'InvoiceService' provides business logic for managing invoices, including creation, updating, retrieval, and soft deletion within a Spring Boot application. It interacts with various repositories to perform database operations, handles transaction management, and uses data transfer objects for input handling.", "external_files": ["com.example.invoicebackend.model.*", "com.example.invoicebackend.repository.*", "com.example.invoicebackend.web.dto.InvoiceDtos.*", "com.example.invoicebackend.web.mapper.DtoMappers"], "external_methods": ["repositories.findById()", "repositories.findByPartnerAndInvoiceNumber()", "Invoice.recalcTotals()", "DtoMappers.applyInvoiceItemFromRequest()", "DtoMappers.normalizeMoney()", "DtoMappers.applyInvoiceUpdateFromRequest()", "DtoMappers.setDefaultInvoiceStatusIfMissing()"], "published": ["InvoiceService"], "classes": [{"name": "InvoiceService", "description": "Service class that manages invoice operations such as creation, update, retrieval, and soft-deletion, leveraging Spring transaction management and repositories."}], "methods": [{"name": "create", "description": "Creates a new invoice with associated items, calculates totals, and ensures invoice number uniqueness per partner."}, {"name": "update", "description": "Updates an existing invoice, potentially replacing items, and recalculates totals."}, {"name": "find", "description": "Retrieves an invoice by its ID."}, {"name": "listByPartner", "description": "Lists all non-deleted invoices associated with a specified partner."}, {"name": "softDelete", "description": "Marks an invoice as deleted without removing it from the database."}], "calls": ["partners.findById()", "customers.findById()", "templates.findById()", "invoices.findByPartnerAndInvoiceNumber()", "invoices.findById()", "inv.setPartner()", "inv.setCustomer()", "inv.setTemplate()", "inv.setInvoiceNumber()", "inv.setCurrency()", "inv.setIssueDate()", "inv.setDueDate()", "inv.setTaxAmount()", "inv.setDiscountAmount()", "inv.setNotes()", "inv.setStatus()", "inv.setItems()", "inv.recalcTotals()", "invoices.save()", "DtoMappers.applyInvoiceItemFromRequest()", "DtoMappers.normalizeMoney()", "DtoMappers.applyInvoiceUpdateFromRequest()", "DtoMappers.setDefaultInvoiceStatusIfMissing()"], "search-terms": ["InvoiceService", "create invoice", "update invoice", "soft delete", "invoice items management", "invoice totals calculation", "Transaction management", "partner and customer validation", "invoice number uniqueness"], "state": 2, "file_id": 57, "knowledge_revision": 122, "git_revision": "", "hash": "28306dee9a3c54ceeb754132634efd9a", "format-version": 4, "code-base-name": "invoice_backend", "filename": "invoice_backend/src/main/java/com/example/invoicebackend/service/InvoiceService.java", "revision_history": [{"122": ""}]}